const User = require("../../../../models/User");
const bcrypt = require('bcrypt')
const nodemailer = require('nodemailer')
const { hashPassword } = require('../../../../../utils/auth');

module.exports = {

    forgotPassword: async (req, res, next) => {
        const email = req.body.email;

        try {
            const user = await User.findOne({ email: email }).exec();

            if (!user) {
                // req.flash('error', 'No account with that email address exists.');
                // console.log(req.flash('error'));
                // res.redirect('/admin/login');

                req.flash('error', `No account with email address "${email}" exists.`);
                res.redirect('/admin/login');

            } else {

                const hash = bcrypt.hashSync(email, 10);
                const token = hash.replace(/\//g, '');
                console.log(token)
                user.resetPasswordToken = token;
                user.resetPasswordExpires = Date.now() + 3600000; // 1 hour

                console.log(user);

                await user.save();

                const transporter = nodemailer.createTransport({
                    host: "sandbox.smtp.mailtrap.io",
                    port: 2525,
                    auth: {
                        user: "60cdaa337896fb",
                        pass: "9486eba100e56f"
                    }
                });

                const mailOptions = {
                    to: email,
                    from: process.env.EMAIL,
                    subject: 'Reset your password on MyApp',
                    html: `<div class="container"><img class="logo" src="data:image/png;base64,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" alt="Logo"><p>Hello,</p><p>You are receiving this email because you (or someone else) have requested the reset of the password for your account.</p><br><br><p>Please click on the following link, or paste it into your browser to complete the process:<p><br><br><form method="post" action="http://${req.headers.host}/admin/forgot-password/reset/${token}"><a href="http://${req.headers.host}/admin/forgot-password/reset/${token}">http://${req.headers.host}/admin/forgot-password/reset/${token}</a><br><br><p>If you did not request this, please ignore this email and your password will remain unchanged.</p></div><style>body {font-family: Arial, sans-serif;font-size: 14px;line-height: 1.5;color: #333333;background-color: #f7f7f7;margin: 0;padding: 0;}.container {width: 100%;height: 100%;display: flex;flex-direction: column;justify-content: center;align-items: center;text-align: center;}.logo {max-width: 200px;margin-bottom: 20px;}</style>`
                };

                try {
                    await transporter.sendMail(mailOptions, (error, info) => {
                        if (error) {
                            console.log(error);
                            req.flash('error', 'An error occured on sending mail (' + info.response + ' )')
                        } else {
                            console.log('Email sent: ' + info.response);
                            req.flash('success', `An e-mail has been sent to "${email}" with further instructions.`);
                            res.redirect('/admin/login');
                        }
                    });

                } catch (error) {
                    console.log(error);
                }


                console.log('mail sent');

            }
        } catch (err) {
            console.log(err);
        }

    },

    emailVerificationPage: async (req, res, next) => {
        let token = req.params.token;
        let successMessage = req.flash('success');
        let errorMessage = req.flash('error');
        const csrfToken = req.csrfToken();

        console.log([token, req.body, req])
        try {
            if (token) {

                await User.findOne({ resetPasswordToken: token, resetPasswordExpires: { $gt: Date.now() } }, (err, user) => {

                    if (err) {
                        console.log(err)
                        req.flash('error', 'Some internal error occured.');
                        return res.redirect('/admin/login');
                    }

                    if (!user) {
                        console.log('ppppppp==>');
                        req.flash('error', 'Password reset token is invalid or has expired.');
                        return res.redirect('/admin/login');
                    }

                    res.render("admin/authentication/forgotPassword/index", { title: "Admin Forgot Password", token: token, layout: "admin/authentication/layout/main", successMessage: successMessage, errorMessage: errorMessage, csrfToken: csrfToken });

                });
            } else {
                req.flash('error', 'Password reset token is invalid or has expired.');
                return res.redirect('/admin/login');
            }
        } catch (err) {

        }

    },

    emailVerification: async (req, res, next) => {
        console.log('ffffff===>', req.body.token)

        let token = req.body.token;
        let password = req.body.password;
        let rePassword = req.body.rePassword;

        console.log(['token=>', token])
        console.log(['password=>', password])
        console.log(['rePassword=>', rePassword])


        try {

            if (token) {
                if (password === rePassword) {
                    await User.findOne({ resetPasswordToken: token, resetPasswordExpires: { $gt: Date.now() } }, async (err, user) => {
                        if (err) {
                            console.log(err)
                        }


                        if (!user) {
                            console.log('pp=====--pp')
                            req.flash('error', 'Password reset token is invalid or has expired.');
                            return res.redirect('/admin/login');
                        }
                        let hashedPassword = await hashPassword(password)
                        user.password = hashedPassword.data.hashedValue;
                        user.resetPasswordToken = undefined;
                        user.resetPasswordExpires = undefined;

                        console.log('==========')
                        console.log(user)
                        await user.save((err) => {
                            if (err) {
                                console.log(err);
                            }

                        })

                        req.flash('success', 'Password reset successfuly.');
                        return res.redirect('/admin/login');
                    });


                } else {
                    console.log('//********')
                    req.flash('error', 'Passwords does not match.');
                    res.redirect('/admin/forgot-password/reset/' + token);
                }
            } else {
                console.log('//**//**')
                req.flash('error', 'Password reset token is invalid or has expired.');
                return res.redirect('/admin/login');
            }

        } catch (err) {
            console.log(['-------------------------']);
            console.log(err);

        }

    },
    testC: (req, res, next) => {
        console.log('hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh')
    }
}